# 开发组 App 需求与实现指南

本指南汇总 App 侧的明确需求与对接约定，覆盖用户端（Client）与管理端（Admin），以及端侧模型、数据隐私与服务端部署要求。

## 目标与范围
- 技术选型：开发组自行决定（Flutter、React Native、原生 Android 等）。
- 平台兼容：最低要求为 Android（安卓端独占即可）。
- 客户端模块：用户端（AI 咨询、心理问卷、个人中心）与管理端（问卷发布与处理）。
- 服务端部署：App 服务器端需要部署在云服务器（如：阿里云 ECS）。

## 客户端功能（用户端）
- AI 心理咨询
  - 使用端侧模型 `basemodel/chat.gguf` 进行对话生成。
  - 咨询过程中，使用端侧模型 `basemodel/judgement.gguf` 对用户心理状态进行实时判断与标注（仅本地使用）。
  - 会话数据存储在本地（隐私保护），支持用户清理与导出（如需）。
- 心理问卷调查
  - 渲染标准量表（如 PHQ-9、GAD-7），完成评分与结果展示。
  - 问卷结果需要上传服务器端存储（用于后端统计与管理端查看）。
- 个人中心
  - 资料与偏好设置、隐私说明、紧急求助入口。
  - 本地数据管理：聊天记录与模型判断结果的查看与清理。

## 管理端功能（Admin）
- 问卷发布
  - 支持创建、更新与下线问卷（题目、选项、评分规则、可见范围）。
- 问卷处理
  - 查看问卷提交结果与统计报表。
  - 导出数据（CSV/JSON）与基础筛选、聚合分析。

## 端侧模型与目录
- 模型文件统一放置于仓库路径：`develop/baseapp/basemodel/`
  - 对话模型：`chat.gguf`
  - 心理状态判断模型：`judgement.gguf`
- 两个模型均在端侧部署与推理，未经用户授权不上传原始对话与判断结果。
- 在 App 工程中引入模型的推荐方式：
  - 将 `basemodel` 目录复制/引用到 App 的资源或可读路径（例如 `android/app/src/main/assets/` 或应用私有目录）。
  - 使用对应的推理库（如 ggml/gguf 的 Java/Kotlin/Flutter/RN 封装）加载 `chat.gguf` 与 `judgement.gguf`。

## 数据与隐私
- 本地存储（隐私保护）
  - 聊天数据：仅本地保存，支持用户一键清理；默认不上传。
  - 心理状态评估结果（模型判断）：仅本地保存，默认不上传。
- 服务器端存储
  - 问卷结果：需要上传至服务器端，用于统计与管理端查看。
- 建议：本地数据加密（SQLite/文件加密）、显式隐私说明、最小化收集原则、离线模式下不影响基本使用。

## 服务端与部署
- 部署位置：云服务器（如阿里云 ECS），开启 HTTPS 与基础安全组配置。
- 参考后端：`develop/services/api`（FastAPI 骨架，可扩展问卷管理与结果存储接口）。
- 基本约定：
  - App 端通过 `BASE_URL` 指向云端地址（例如 `https://your-domain.example/`）。
  - 问卷相关接口需提供：
    - `GET /questionnaires`：拉取已发布问卷列表与内容。
    - `POST /assessment/submit`：提交问卷结果，服务端持久化。
  - Chat 与心理状态判断在端侧完成；如需云端兜底，请单独评估与开关控制。

## 接口约定（与本仓库保持一致的初版）
- 开发组自行决定

## 兼容性
- Android 为最低兼容平台。


## 验收标准
- 用户端：
  - AI 咨询可用：对话生成与心理状态本地判断正常工作。
  - 问卷：渲染与评分准确；结果成功上传至服务器端并可在管理端查看。
  - 个人中心：隐私说明与数据清理入口可用。
- 管理端：
  - 问卷发布流程顺畅，接口与前端联动正常。
  - 结果处理页面可查看与导出统计数据。
- 安全与隐私：
  - 本地数据默认不上传；HTTPS 与鉴权策略生效（如需）。
  - 明确的隐私政策与用户同意流程。
