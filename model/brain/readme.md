# LocalBrain Agent è·¯ç”±æ¨¡å‹

è½»é‡çº§ Agent è·¯ç”±æ¨¡å‹ï¼Œç”¨äºæ™ºèƒ½å†³ç­–å’Œå·¥å…·è°ƒç”¨ã€‚ä½œä¸º"å†³ç­–å¤§è„‘"ï¼Œå®ƒèƒ½æ ¹æ®ç”¨æˆ·è¾“å…¥åˆ¤æ–­åº”è¯¥è°ƒç”¨å“ªäº›å·¥å…·ã€‚

## ğŸ“– é¡¹ç›®ç®€ä»‹

Brain æ¨¡å‹æ˜¯ä¸€ä¸ªè½»é‡çº§çš„ Routerï¼Œè´Ÿè´£ï¼š
1. **æ„å›¾è¯†åˆ«**ï¼šåˆ¤æ–­ç”¨æˆ·æ˜¯é—²èŠã€éœ€è¦è¯„ä¼°è¿˜æ˜¯æŸ¥è¯¢å†å²
2. **å·¥å…·è°ƒç”¨**ï¼šè¾“å‡ºæ ‡å‡† JSON æ ¼å¼çš„å·¥å…·è°ƒç”¨æŒ‡ä»¤
3. **å‚æ•°æå–**ï¼šä»ç”¨æˆ·è¾“å…¥ä¸­æå–å·¥å…·æ‰€éœ€å‚æ•°

## ğŸ¯ æ”¯æŒçš„å·¥å…·

| å·¥å…·å | åŠŸèƒ½ | è¯´æ˜ |
|--------|------|------|
| `local_chat` | æ—¥å¸¸å¯¹è¯å’Œå¿ƒç†å’¨è¯¢ | è°ƒç”¨æ›´å¤§çš„å¯¹è¯æ¨¡å‹ |
| `psychological_assessment` | å¿ƒç†çŠ¶æ€ä¸“ä¸šè¯„ä¼° | è¾“å‡ºç»“æ„åŒ–è¯„ä¼°ç»“æœ |
| `memory_query` | å†å²å¯¹è¯æŸ¥è¯¢ | æ£€ç´¢å¯¹è¯è®°å¿† |

## ğŸ“ ç›®å½•ç»“æ„

```
brain/
â”œâ”€â”€ data/                           # è®­ç»ƒæ•°æ®
â”‚   â”œâ”€â”€ brain_training_data.json    # åŸå§‹è®­ç»ƒæ•°æ®
â”‚   â”œâ”€â”€ brain_training_data_*.json  # æ‰©å±•/åˆå¹¶æ•°æ®
â”‚   â””â”€â”€ brain_v2/                   # V2ç‰ˆæœ¬æ•°æ®
â”œâ”€â”€ docs/                           # æŠ€æœ¯æ–‡æ¡£
â”‚   â”œâ”€â”€ BRAIN_LLM_V2_README.md
â”‚   â”œâ”€â”€ LIGHT_AGENT_TRAINING_GUIDE.md
â”‚   â””â”€â”€ PROJECT_STRUCTURE.md
â”œâ”€â”€ finetune/                       # å¾®è°ƒé…ç½®
â”‚   â”œâ”€â”€ train_brain_v2.yaml
â”‚   â””â”€â”€ train_brain_v2.sh
â”œâ”€â”€ scripts/                        # è„šæœ¬å·¥å…·
â”‚   â”œâ”€â”€ train_brain_v2.sh           # è®­ç»ƒè„šæœ¬
â”‚   â”œâ”€â”€ test_brain_model.py         # æµ‹è¯•è„šæœ¬
â”‚   â”œâ”€â”€ merge_brain_lora.py         # åˆå¹¶LoRAæƒé‡
â”‚   â”œâ”€â”€ convert_brain_to_gguf.sh    # è½¬æ¢ä¸ºGGUFæ ¼å¼
â”‚   â”œâ”€â”€ rebuild_brain_data.py       # æ•°æ®é‡å»ºè„šæœ¬
â”‚   â””â”€â”€ rebuild_brain_data_v2.py    # V2æ•°æ®é‡å»º
â”œâ”€â”€ examples_experiment/            # å®éªŒç¤ºä¾‹ä¸ç»“æœ
â””â”€â”€ readme.md
```

## ğŸ› ï¸ æŠ€æœ¯è§„æ ¼

| é¡¹ç›® | è§„æ ¼ |
|------|------|
| åŸºåº§æ¨¡å‹ | Qwen2.5-0.5B-Instruct |
| å¾®è°ƒæ–¹æ³• | LoRA (rank=16, alpha=32) |
| å‚æ•°é‡ | 0.5B |
| è®­ç»ƒæŒ‡æ ‡ | train_loss: 0.0377, 5 epochs |
| è¾“å‡ºæ ¼å¼ | JSONå·¥å…·è°ƒç”¨æŒ‡ä»¤ |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### è®­ç»ƒæ¨¡å‹
```bash
cd scripts
./train_brain_v2.sh
```

### æµ‹è¯•æ¨¡å‹
```bash
python scripts/test_brain_model.py
```

### åˆå¹¶æƒé‡
```bash
python scripts/merge_brain_lora.py
```

### è½¬æ¢ä¸º GGUF
```bash
./scripts/convert_brain_to_gguf.sh
```

## ğŸ“Š è¾“å‡ºç¤ºä¾‹

ç”¨æˆ·è¾“å…¥ï¼š`"æˆ‘æœ€è¿‘å¾ˆç„¦è™‘ï¼Œç¡ä¸å¥½è§‰"`

Brain è¾“å‡ºï¼š
```json
{
  "tool": "psychological_assessment",
  "parameters": {
    "trigger_reason": "ç”¨æˆ·è¡¨è¾¾ç„¦è™‘å’Œç¡çœ é—®é¢˜"
  }
}
```

ç”¨æˆ·è¾“å…¥ï¼š`"ä»Šå¤©å¤©æ°”çœŸå¥½"`

Brain è¾“å‡ºï¼š
```json
{
  "tool": "local_chat",
  "parameters": {
    "message": "ä»Šå¤©å¤©æ°”çœŸå¥½"
  }
}
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Brain LLM V2 è®­ç»ƒæŒ‡å—](docs/BRAIN_LLM_V2_README.md)
- [Light Agent æ¶æ„åˆ†æ](docs/LIGHT_AGENT_TRAINING_GUIDE.md)

## ğŸ”— ä¸ App é›†æˆ

Brain æ¨¡å‹åœ¨ Android App ä¸­ä½œä¸º `LocalBrainProvider` é›†æˆï¼Œè´Ÿè´£ï¼š
- æ¥æ”¶ç”¨æˆ·è¾“å…¥
- åˆ¤æ–­è°ƒç”¨å“ªä¸ªå·¥å…·
- è¿”å›å·¥å…·è°ƒç”¨æŒ‡ä»¤ä¾› AgentCore æ‰§è¡Œ

---

**æœ€åæ›´æ–°**: 2025-12

